<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Sample log posterior and gradient functions for select generalized linear models
and mixed effect models — hmclearn-glm-posterior • hmclearn</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Sample log posterior and gradient functions for select generalized linear models
and mixed effect models — hmclearn-glm-posterior" />
<meta property="og:description" content="These functions can be used to fit common generalized linear models and mixed effect models.
See the accompanying vignettes for details on the derivations of the log posterior and gradient.
In addition, these functions can be used as templates to build custom models to fit using HMC." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hmclearn</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/linear_mixed_effects_hmclearn.html">hmclearn:  Linear Mixed Effects Regression Example</a>
    </li>
    <li>
      <a href="../articles/linear_regression_hmclearn.html">hmclearn:  Linear Regression Example</a>
    </li>
    <li>
      <a href="../articles/logistic_mixed_effects_hmclearn.html">hmclearn:  Logistic Mixed Effects Regression Example</a>
    </li>
    <li>
      <a href="../articles/logistic_regression_hmclearn.html">hmclearn:  Logistic Regression Example</a>
    </li>
    <li>
      <a href="../articles/poisson_regression_hmclearn.html">hmclearn:  Poisson Regression Example</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sample log posterior and gradient functions for select generalized linear models
and mixed effect models</h1>
    
    <div class="hidden name"><code>hmclearn-glm-posterior.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These functions can be used to fit common generalized linear models and mixed effect models.
See the accompanying vignettes for details on the derivations of the log posterior and gradient.
In addition, these functions can be used as templates to build custom models to fit using HMC.</p>
    </div>

    <pre class="usage"><span class='fu'>linear_posterior</span><span class='op'>(</span><span class='va'>theta</span>, <span class='va'>y</span>, <span class='va'>X</span>, a <span class='op'>=</span> <span class='fl'>1e-04</span>, b <span class='op'>=</span> <span class='fl'>1e-04</span>, sig2beta <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span>

<span class='fu'>g_linear_posterior</span><span class='op'>(</span><span class='va'>theta</span>, <span class='va'>y</span>, <span class='va'>X</span>, a <span class='op'>=</span> <span class='fl'>1e-04</span>, b <span class='op'>=</span> <span class='fl'>1e-04</span>, sig2beta <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span>

<span class='fu'>logistic_posterior</span><span class='op'>(</span><span class='va'>theta</span>, <span class='va'>y</span>, <span class='va'>X</span>, sig2beta <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span>

<span class='fu'>g_logistic_posterior</span><span class='op'>(</span><span class='va'>theta</span>, <span class='va'>y</span>, <span class='va'>X</span>, sig2beta <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span>

<span class='fu'>poisson_posterior</span><span class='op'>(</span><span class='va'>theta</span>, <span class='va'>y</span>, <span class='va'>X</span>, sig2beta <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span>

<span class='fu'>g_poisson_posterior</span><span class='op'>(</span><span class='va'>theta</span>, <span class='va'>y</span>, <span class='va'>X</span>, sig2beta <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span>

<span class='fu'>lmm_posterior</span><span class='op'>(</span>
  <span class='va'>theta</span>,
  <span class='va'>y</span>,
  <span class='va'>X</span>,
  <span class='va'>Z</span>,
  <span class='va'>n</span>,
  <span class='va'>d</span>,
  nrandom <span class='op'>=</span> <span class='fl'>1</span>,
  nugamma <span class='op'>=</span> <span class='fl'>1</span>,
  nuxi <span class='op'>=</span> <span class='fl'>1</span>,
  Agamma <span class='op'>=</span> <span class='fl'>25</span>,
  Axi <span class='op'>=</span> <span class='fl'>25</span>,
  sig2beta <span class='op'>=</span> <span class='fl'>1000</span>
<span class='op'>)</span>

<span class='fu'>g_lmm_posterior</span><span class='op'>(</span>
  <span class='va'>theta</span>,
  <span class='va'>y</span>,
  <span class='va'>X</span>,
  <span class='va'>Z</span>,
  <span class='va'>n</span>,
  <span class='va'>d</span>,
  nrandom <span class='op'>=</span> <span class='fl'>1</span>,
  nugamma <span class='op'>=</span> <span class='fl'>1</span>,
  nuxi <span class='op'>=</span> <span class='fl'>1</span>,
  Agamma <span class='op'>=</span> <span class='fl'>25</span>,
  Axi <span class='op'>=</span> <span class='fl'>25</span>,
  sig2beta <span class='op'>=</span> <span class='fl'>1000</span>
<span class='op'>)</span>

<span class='fu'>glmm_bin_posterior</span><span class='op'>(</span>
  <span class='va'>theta</span>,
  <span class='va'>y</span>,
  <span class='va'>X</span>,
  <span class='va'>Z</span>,
  <span class='va'>n</span>,
  nrandom <span class='op'>=</span> <span class='fl'>1</span>,
  nuxi <span class='op'>=</span> <span class='fl'>1</span>,
  Axi <span class='op'>=</span> <span class='fl'>25</span>,
  sig2beta <span class='op'>=</span> <span class='fl'>1000</span>
<span class='op'>)</span>

<span class='fu'>g_glmm_bin_posterior</span><span class='op'>(</span>
  <span class='va'>theta</span>,
  <span class='va'>y</span>,
  <span class='va'>X</span>,
  <span class='va'>Z</span>,
  <span class='va'>n</span>,
  nrandom <span class='op'>=</span> <span class='fl'>1</span>,
  nuxi <span class='op'>=</span> <span class='fl'>1</span>,
  Axi <span class='op'>=</span> <span class='fl'>25</span>,
  sig2beta <span class='op'>=</span> <span class='fl'>1000</span>
<span class='op'>)</span>

<span class='fu'>glmm_poisson_posterior</span><span class='op'>(</span>
  <span class='va'>theta</span>,
  <span class='va'>y</span>,
  <span class='va'>X</span>,
  <span class='va'>Z</span>,
  <span class='va'>n</span>,
  nrandom <span class='op'>=</span> <span class='fl'>1</span>,
  nuxi <span class='op'>=</span> <span class='fl'>1</span>,
  Axi <span class='op'>=</span> <span class='fl'>25</span>,
  sig2beta <span class='op'>=</span> <span class='fl'>1000</span>
<span class='op'>)</span>

<span class='fu'>g_glmm_poisson_posterior</span><span class='op'>(</span>
  <span class='va'>theta</span>,
  <span class='va'>y</span>,
  <span class='va'>X</span>,
  <span class='va'>Z</span>,
  <span class='va'>n</span>,
  nrandom <span class='op'>=</span> <span class='fl'>1</span>,
  nuxi <span class='op'>=</span> <span class='fl'>1</span>,
  Axi <span class='op'>=</span> <span class='fl'>25</span>,
  sig2beta <span class='op'>=</span> <span class='fl'>1000</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>theta</th>
      <td><p>vector of parameters.  See details below for the order of parameters for each model</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>numeric vector for the dependent variable for all models</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>numeric design matrix of fixed effect parameters for all models</p></td>
    </tr>
    <tr>
      <th>a</th>
      <td><p>hyperparameter for the Inverse Gamma shape parameter for \(\sigma_\epsilon\) in linear regression models</p></td>
    </tr>
    <tr>
      <th>b</th>
      <td><p>hyperparameter for the Inverse Gamma scale parameter for \(\sigma_\epsilon\) in linear regression models</p></td>
    </tr>
    <tr>
      <th>sig2beta</th>
      <td><p>diagonal covariance of prior for linear predictors is multivariate normal with mean 0 for linear regression and linear mixed effect models.</p></td>
    </tr>
    <tr>
      <th>Z</th>
      <td><p>numeric design matrix of random effect parameters for all mixed effects models</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>number of observations for standard glm models, or number of subjects for all mixed effect models</p></td>
    </tr>
    <tr>
      <th>d</th>
      <td><p>number of observations per subject for mixed effects models, but an input for linear mixed effect models only.</p></td>
    </tr>
    <tr>
      <th>nrandom</th>
      <td><p>number of random effects covariance parameters for all mixed effects models</p></td>
    </tr>
    <tr>
      <th>nugamma</th>
      <td><p>hyperparameter \(\nu\) for the half-t prior of the log transformed error for linear mixed effects model \(\gamma\)</p></td>
    </tr>
    <tr>
      <th>nuxi</th>
      <td><p>hyperparameter \(\nu\) for the half-t prior of the random effects diagonal for all mixed effects models \(\xi\)</p></td>
    </tr>
    <tr>
      <th>Agamma</th>
      <td><p>hyperparameter \(A\) for the half-t prior of the log transformed error for linear mixed effects model \(\gamma\)</p></td>
    </tr>
    <tr>
      <th>Axi</th>
      <td><p>hyperparameter \(A\) for the half-t prior of the random effects diagonal for all mixed effects models\(\xi\)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Numeric vector for the log posterior or gradient of the log posterior</p>
    <h2 class="hasAnchor" id="generalized-linear-models-with-available-posterior-and-gradient-functions"><a class="anchor" href="#generalized-linear-models-with-available-posterior-and-gradient-functions"></a>Generalized Linear Models with available posterior and gradient functions</h2>

    

<dl>
  <dt>`linear_posterior(theta, y, X, a=1e-4, b=1e-4, sig2beta = 1e3)`</dt><dd><p>The log posterior function for linear regression
   $$f(y | X, \beta, \sigma) = \frac{1}{(2\pi\sigma^2)^{n/2}}\exp{\left(-\frac{1}{2\sigma^2} (y - X\beta)^T(y-X\beta) \right)}$$
   with priors \(p(\sigma^2) \sim IG(a, b)\) and \(\beta \sim N(0, \sigma_\beta^2 I)\).  The variance term is log transformed \(\gamma = \log\sigma\)
   The input parameter vector \(theta\) is of length \(k\).  The first \(k-1\) parameters are for \(\beta\), and the last parameter is \(\gamma\)
   Note that the Inverse Gamma prior can be problematic for certain applications with low variance, such as hierarchical models.  See Gelman (2006)</p></dd>
  <dt>`g_linear_posterior(theta, y, X, a = 1e-04, b = 1e-04, sig2beta=1e3)`</dt><dd><p>Gradient of the log posterior for a linear regression model with Normal prior for the linear parameters and Inverse Gamma for the error term.
   $$f(y | X, \beta, \sigma) = \frac{1}{(2\pi\sigma^2)^{n/2}}\exp{\left(-\frac{1}{2\sigma^2} (y - X\beta)^T(y-X\beta) \right)}$$
   with priors \(p(\sigma^2) \sim IG(a, b)\) and \(\beta \sim N(0, \sigma_\beta^2 I)\).  The variance term is log transformed \(\gamma = \log\sigma\)
   The input parameter vector \(theta\) is of length \(k\).  The first \(k-1\) parameters are for \(\beta\), and the last parameter is \(\gamma\)
   Note that the Inverse Gamma prior can be problematic for certain applications with low variance, such as hierarchical models.  See Gelman (2006)</p></dd>
  <dt>`logistic_posterior(theta, y, X, sig2beta=1e3) `</dt><dd><p>Log posterior for a logistic regression model with Normal prior for the linear parameters.
   The likelihood function for logistic regression
   $$f(\beta| X, y) = \prod_{i=1}^{n} \left(\frac{1}{1+e^{-X_i\beta}}\right)^{y_i} \left(\frac{e^{-X_i\beta}}{1+e^{-X_i\beta}}\right)^{1-y_i}$$
   with priors \(\beta \sim N(0, \sigma_\beta^2 I)\).
   The input parameter vector \(theta\) is of length \(k\), containing parameter values for \(\beta\)</p></dd>
  <dt>`g_logistic_posterior(theta, y, X, sig2beta=1e3) `</dt><dd><p>Gradient of the log posterior for a logistic regression model with Normal prior for the linear parameters.
   The likelihood function for logistic regression
   $$f(\beta| X, y) = \prod_{i=1}^{n} \left(\frac{1}{1+e^{-X_i\beta}}\right)^{y_i} \left(\frac{e^{-X_i\beta}}{1+e^{-X_i\beta}}\right)^{1-y_i}$$
   with priors \(\beta \sim N(0, \sigma_\beta^2 I)\).
   The input parameter vector \(theta\) is of length \(k\), containing parameter values for \(\beta\)</p></dd>
  <dt>`poisson_posterior(theta, y, X, sig2beta=1e3) `</dt><dd><p>Log posterior for a Poisson regression model with Normal prior for the linear parameters.
   The likelihood function for poisson regression
   $$f(\beta| y, X) = \prod_{i=1}^n \frac{e^{-e^{X_i\beta}}e^{y_iX_i\beta}}{y_i!}$$
   with priors \(\beta \sim N(0, \sigma_\beta^2 I)\).
   The input parameter vector \(theta\) is of length \(k\), containing parameter values for \(\beta\)</p></dd>
  <dt>`g_poisson_posterior(theta, y, X, sig2beta=1e3) `</dt><dd><p>Gradient of the log posterior for a Poisson regression model with Normal prior for the linear parameters.
   The likelihood function for poisson regression
   $$f(\beta| y, X) = \prod_{i=1}^n \frac{e^{-e^{X_i\beta}}e^{y_iX_i\beta}}{y_i!}$$
   with priors \(\beta \sim N(0, \sigma_\beta^2 I)\).
   The input parameter vector \(theta\) is of length \(k\), containing parameter values for \(\beta\)</p></dd>
 
</dl>

    <h2 class="hasAnchor" id="generalized-linear-mixed-effect-with-available-posterior-and-gradient-functions"><a class="anchor" href="#generalized-linear-mixed-effect-with-available-posterior-and-gradient-functions"></a>Generalized Linear Mixed Effect with available posterior and gradient functions</h2>

    

<dl>
  <dt>`lmm_posterior(theta, y, X, Z, n, d, nrandom = 1, nueps = 1, nuxi = 1, Aeps = 25, Axi = 25, sig2beta = 1e3) `</dt><dd><p>The log posterior function for linear mixed effects regression
   $$f(y | \beta, u, \sigma_\epsilon) \propto (\sigma_\epsilon^2)^{-nd/2} e^{-\frac{1}{2\sigma_\epsilon^2}(y - X\beta - Zu)^T (y - X\beta - Zu)}$$
   with priors \(\beta \sim N(0, \sigma_\beta^2 I)\), \(\sigma_\epsilon \sim half-t(A_\epsilon, nu_\epsilon)\), \(\lambda \sim half-t\).
   The vector \(\xi\) is the diagonal of the covariance \(G\) log transformed hyperprior where \(u \sim N(0, G\), \(\xi = \log\lambda\) and \(A_\xi, \nu_\xi\) are parameters for the transformed distribution
   The standard deviation of the error is log transformed, where \(\gamma = \log \sigma_\epsilon\) and \(\sigma_\epsilon \sim half-t\). The parameters for \(\gamma\) are \(A_\gamma, \nu_\gamma\)
   The input parameter vector \(theta\) is of length \(k\).  The order of parameters for the vector is \(\beta, \tau, \gamma, \xi\).</p></dd>
  <dt>`g_lmm_posterior(theta, y, X, Z, n, d, nrandom = 1, nueps = 1, nuxi = 1, Aeps = 25, Axi = 25, sig2beta = 1e3)`</dt><dd><p>Gradient of the log posterior for a linear mixed effects regression model
   $$f(y | \beta, u, \sigma_\epsilon) \propto (\sigma_\epsilon^2)^{-n/2} e^{-\frac{1}{2\sigma_\epsilon^2}(y - X\beta - Zu)^T (y - X\beta - Zu)}$$
   with priors \(\beta \sim N(0, \sigma_\beta^2 I)\), \(\sigma_\epsilon \sim half-t(A_\epsilon, nu_\epsilon)\), \(\lambda \sim half-t\).
   The vector \(\xi\) is the diagonal of the covariance \(G\) log transformed hyperprior where \(u \sim N(0, G\), \(\xi = \log\lambda\) and \(A_\xi, \nu_\xi\) are parameters for the transformed distribution
   The standard deviation of the error is log transformed, where \(\gamma = \log \sigma_\epsilon\) and \(\sigma_\epsilon \sim half-t\). The parameters for \(\gamma\) are \(A_\gamma, \nu_\gamma\)
   The input parameter vector \(theta\) is of length \(k\).  The order of parameters for the vector is \(\beta, \tau, \gamma, \xi\)</p></dd>
  <dt>`glmm_bin_posterior(theta, y, X, Z, n, nrandom = 1, nuxi = 1, Axi = 25, sig2beta=1e3)`</dt><dd><p>The log posterior function for logistic mixed effects regression
   $$f(y | X, Z, \beta, u) = \prod_{i=1}^n\prod_{j=1}^d \left(\frac{1}{1 + e^{-X_{i}\beta - Z_{ij}u_i}}\right)^{y_{ij}} \left(\frac{e^{-X_i\beta - Z_{ij}u_i}}{1 + e^{-X_{i}\beta - Z_{ij}u_i}}\right)^{1-y_{ij}} $$
   with priors \(\beta \sim N(0, \sigma_\beta^2 I)\), \(\sigma_\epsilon \sim half-t(A_\epsilon, nu_\epsilon)\), \(\lambda \sim half-t(A_\lambda, nu_\lambda )\).
   The vector \(\lambda\) is the diagonal of the covariance \(G\) hyperprior where \(u \sim N(0, G\), \(\xi = \log\lambda\) and \(A_\xi, \nu_\xi\) are parameters for the transformed distribution
   The input parameter vector \(theta\) is of length \(k\).  The order of parameters for the vector is \(\beta, \tau, \xi\)</p></dd>
  <dt>`g_glmm_bin_posterior(theta, y, X, Z, n, nrandom = 1, nuxi = 1, Axi = 25, sig2beta = 1e3) `</dt><dd><p>Gradient of the log posterior function for logistic mixed effects regression
   $$f(y | X, Z, \beta, u) = \prod_{i=1}^n\prod_{j=1}^m \left(\frac{1}{1 + e^{-X_{i}\beta - Z_{ij}u_i}}\right)^{y_{ij}} \left(\frac{e^{-X_i\beta - Z_{ij}u_i}}{1 + e^{-X_{i}\beta - Z_{ij}u_i}}\right)^{1-y_{ij}} $$
   with priors \(\beta \sim N(0, \sigma_\beta^2 I)\), \(\sigma_\epsilon \sim half-t(A_\epsilon, nu_\epsilon)\), \(\lambda \sim half-t(A_\lambda, nu_\lambda )\).
   The vector \(\lambda\) is the diagonal of the covariance \(G\) hyperprior where \(u \sim N(0, G\), \(\xi = \log\lambda\) and \(A_\xi, \nu_\xi\) are parameters for the transformed distribution
   The input parameter vector \(theta\) is of length \(k\).  The order of parameters for the vector is \(\beta, \tau, \xi\)</p></dd>
  <dt>`glmm_poisson_posterior(theta, y, X, Z, n, nrandom = 1, nuxi = 1, Axi = 25, sig2beta = 1e3) `</dt><dd><p>Log posterior for a Poisson mixed effect regression
   $$f(y | X, Z, \beta, u) = \prod_{i=1}^n \prod_{j=1}^m \frac{e^{-e^{X_i\beta + Z_{ij}u_{ij}}}e^{y_i(X_i\beta + Z_{ij}u_{ij})}}{y_i!} $$
   with priors \(\beta \sim N(0, \sigma_\beta^2 I)\), \(\sigma_\epsilon \sim half-t(A_\epsilon, nu_\epsilon)\), \(\lambda \sim half-t(A_\lambda, nu_\lambda )\).
   The vector \(\lambda\) is the diagonal of the covariance \(G\) hyperprior where \(u \sim N(0, G\), \(\xi = \log\lambda\) and \(A_\xi, \nu_\xi\) are parameters for the transformed distribution
   The input parameter vector \(theta\) is of length \(k\).  The order of parameters for the vector is \(\beta, \tau, \xi\)</p></dd>
  <dt>`g_glmm_poisson_posterior(theta, y, X, Z, n, nrandom = 1, nuxi = 1, Axi = 25, sig2beta = 1e3) `</dt><dd><p>Gradient of the log posterior for a Poisson mixed effect regression
   $$f(y | X, Z, \beta, u) = \prod_{i=1}^n \prod_{j=1}^m \frac{e^{-e^{X_i\beta + Z_{ij}u_{ij}}}e^{y_i(X_i\beta + Z_{ij}u_{ij})}}{y_i!} $$
   with priors \(\beta \sim N(0, \sigma_\beta^2 I)\), \(\sigma_\epsilon \sim half-t(A_\epsilon, nu_\epsilon)\), \(\lambda \sim half-t(A_\lambda, nu_\lambda )\).
   The vector \(\lambda\) is the diagonal of the covariance \(G\) hyperprior where \(u \sim N(0, G\), \(\xi = \log\lambda\) and \(A_\xi, \nu_\xi\) are parameters for the transformed distribution
   The input parameter vector \(theta\) is of length \(k\).  The order of parameters for the vector is \(\beta, \tau, \xi\)</p></dd>
 
</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Gelman, A. (2006). <em>Prior distributions for variance parameters in hierarchical models (comment on article by Browne and Draper)</em>. Bayesian analysis, 1(3), 515-534.</p>
<p>Chan, J. C. C., &amp; Jeliazkov, I. (2009). <em>MCMC estimation of restricted covariance matrices</em>. Journal of Computational and Graphical Statistics, 18(2), 457-480.</p>
<p>Betancourt, M., &amp; Girolami, M. (2015). <em>Hamiltonian Monte Carlo for hierarchical models</em>. Current trends in Bayesian methodology with applications, 79, 30.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Linear regression example</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>521</span><span class='op'>)</span>
<span class='va'>X</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>300</span><span class='op'>)</span>, ncol<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>betavals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='op'>-</span><span class='fl'>3</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>X</span><span class='op'>%*%</span><span class='va'>betavals</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>100</span>, sd<span class='op'>=</span><span class='fl'>.2</span><span class='op'>)</span>

<span class='va'>f1_hmc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='hmc.html'>hmc</a></span><span class='op'>(</span>N <span class='op'>=</span> <span class='fl'>500</span>,
          theta.init <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>4</span><span class='op'>)</span>, <span class='fl'>1</span><span class='op'>)</span>,
          epsilon <span class='op'>=</span> <span class='fl'>0.01</span>,
          L <span class='op'>=</span> <span class='fl'>10</span>,
          logPOSTERIOR <span class='op'>=</span> <span class='va'>linear_posterior</span>,
          glogPOSTERIOR <span class='op'>=</span> <span class='va'>g_linear_posterior</span>,
          varnames <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"beta"</span>, <span class='fl'>0</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span>, <span class='st'>"log_sigma_sq"</span><span class='op'>)</span>,
          param<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>y</span>, X<span class='op'>=</span><span class='va'>X</span><span class='op'>)</span>, parallel<span class='op'>=</span><span class='cn'>FALSE</span>, chains<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>f1_hmc</span>, burnin<span class='op'>=</span><span class='fl'>100</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Summary of MCMC simulation
#&gt; </div><div class='output co'>#&gt;                    2.5%         5%       25%        50%        75%        95%
#&gt; beta0         0.4778379  0.4847789  0.518149  0.5321988  0.5474873  0.5726653
#&gt; beta1        -1.0435956 -1.0398451 -1.022090 -1.0099795 -0.9969146 -0.9695882
#&gt; beta2         1.9749648  1.9834760  2.003620  2.0201366  2.0330953  2.0521270
#&gt; beta3        -3.0212212 -3.0146309 -2.996771 -2.9813806 -2.9668917 -2.9442674
#&gt; log_sigma_sq -3.2887695 -3.2522864 -3.150465 -3.0570739 -2.9441514 -2.8255475
#&gt;                   97.5%
#&gt; beta0         0.5781760
#&gt; beta1        -0.9622133
#&gt; beta2         2.0554530
#&gt; beta3        -2.9308313
#&gt; log_sigma_sq -2.7737642</div><div class='input'>

<span class='co'># poisson regression example</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>7363</span><span class='op'>)</span>
<span class='va'>X</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>40</span><span class='op'>)</span>, ncol<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>betavals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.8</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='fl'>1.1</span><span class='op'>)</span>
<span class='va'>lmu</span> <span class='op'>&lt;-</span> <span class='va'>X</span> <span class='op'>%*%</span> <span class='va'>betavals</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>lmu</span><span class='op'>)</span>, FUN <span class='op'>=</span> <span class='va'>rpois</span>, n<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>

<span class='va'>f2_hmc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='hmc.html'>hmc</a></span><span class='op'>(</span>N <span class='op'>=</span> <span class='fl'>500</span>,
          theta.init <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>3</span><span class='op'>)</span>,
          epsilon <span class='op'>=</span> <span class='fl'>0.01</span>,
          L <span class='op'>=</span> <span class='fl'>10</span>,
          logPOSTERIOR <span class='op'>=</span> <span class='va'>poisson_posterior</span>,
          glogPOSTERIOR <span class='op'>=</span> <span class='va'>g_poisson_posterior</span>,
          varnames <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"beta"</span>, <span class='fl'>0</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span>,
          param <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>y</span>, X<span class='op'>=</span><span class='va'>X</span><span class='op'>)</span>,
          parallel<span class='op'>=</span><span class='cn'>FALSE</span>, chains<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Samuel Thomas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


